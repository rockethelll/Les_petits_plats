import{recipes}from"../../data/recipes.min.js";import{RecipesFactory}from"../factories/RecipesFactory.min.js";import{displayRecipesCount}from"./displayRecipesCount.min.js";import{displayCleanIcon}from"./cleanInputSearch.min.js";import{updateListOptions}from"./handleDropdown.min.js";import{filteredRecipesState}from"./searchTag.min.js";import{searchByTags}from"./searchTag.min.js";export let currentSearchQuery="";document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("main-search"),t=document.querySelector(".tag-container");e.addEventListener("input",(()=>{currentSearchQuery=e.value.trim().toLowerCase(),applyFilters()})),t.addEventListener("change",(()=>{let e=searchByTags();e&&(filteredRecipesState.filteredRecipesByTags=e),currentSearchQuery&&currentSearchQuery.length>=3&&(e=searchRecipes(currentSearchQuery,e)),updateRecipeSection(e)}))}));export function searchRecipes(e,t=recipes){const r=e.toLowerCase().split(" "),c=[];for(let e=0;e<t.length;e++){const n=t[e],i=`${n.name.toLowerCase()} ${n.description.toLowerCase()} ${n.ingredients.map((e=>e.ingredient.toLowerCase())).join(" ")}`;r.every((e=>i.includes(e)))&&c.push(n)}return c}export function updateRecipeSection(e){const t=document.querySelector(".recipes-gallery");if(t.textContent="",0===e.length){const e=document.createElement("div");e.classList.add("error-message"),e.textContent="Aucune recette ne correspond à votre critère… vous pouvez chercher « tarte aux pommes », « poisson », etc.",t.appendChild(e)}else e.forEach((e=>{const r=new RecipesFactory(e).generateElement();t.appendChild(r)}));displayRecipesCount(e),updateListOptions(e)}export function applyFilters(){let e=recipes;filteredRecipesState.filteredRecipesByTags.length>0&&(e=filteredRecipesState.filteredRecipesByTags),currentSearchQuery&&currentSearchQuery.length>0&&displayCleanIcon(),currentSearchQuery&&currentSearchQuery.length>=3&&(e=searchRecipes(currentSearchQuery,e)),updateRecipeSection(e)}